# 【要件定義書】お題カード生成ツール

## 1\. 概要

### 1.1. 背景

社内イベント（納会など）で実施する伝言ゲームの準備において、お題カードの作成は手作業で行われることが多く、時間的コストや柔軟性の低さが課題となっている。

### 1.2. 目的

本ツールは、可変な設定（お題内容、グループ数、レイアウト）に基づいて、A4用紙に印刷可能な「お題カード」のPDFを自動で生成することを目的とする。これにより、準備作業の効率化と人的ミスの削減を図る。

## 2\. スコープ

### 2.1. 対象範囲（本ツールが実現すること）

  - Pythonスクリプトとして提供されるコマンドラインツールである。
  - スクリプト内の変数として定義された設定値を入力情報とする。
  - 設定値に基づき、A4用紙にグリッドレイアウトされたお題カードのPDFファイルを生成する。
  - 1ページに収まらないカードは、自動で次ページに作成される。

### 2.2. 対象範囲外（本ツールが実現しないこと）

  - GUI（グラフィカル・ユーザー・インターフェース）の実装。
  - お題内容そのものをAI等で自動生成する機能。
  - Webアプリケーションやスマートフォンアプリとしての提供。
  - 印刷機能。

## 3\. 機能要件

### 3.1. 設定機能

| ID | 要件 | 詳細 |
| :--- | :--- | :--- |
| **REQ-001** | お題リスト定義 | 複数のお題をテキスト形式のリストとして定義できること。 |
| **REQ-002** | グループ数指定 | カードセットを準備する対象のグループ数を整数で指定できること。 |
| **REQ-003** | レイアウト指定 | A4用紙1枚あたりのカード配置を、列数（横）と行数（縦）で指定できること。 |
| **REQ-004** | ファイル名指定 | 出力されるPDFのファイル名を文字列で指定できること。 |

### 3.2. PDF生成機能

| ID | 要件 | 詳細 |
| :--- | :--- | :--- |
| **REQ-005** | 用紙設定 | A4サイズ（210mm x 297mm）、縦向きのPDFを生成すること。 |
| **REQ-006** | 日本語表示 | 日本語のお題が文字化けせずに正しく表示されること。（要フォントファイル） |
| **REQ-007** | カード枚数計算 | 総カード枚数を `(お題リストの要素数) × (グループ数)` で自動計算すること。|
| **REQ-008**| 自動改ページ | 1ページに配置できるカード数を超えた場合、自動的に新しいページを追加し、処理を継続すること。 |
| **REQ-009**| グリッドレイアウト | `REQ-003`で指定されたレイアウトに基づき、各カードを指定の余白（マージン）を考慮した上で均等に配置すること。 |
| **REQ-010**| 罫線描画 | 各カードの境界が明確になるよう、切り取り線として利用可能な罫線を描画すること。 |
| **REQ-011**| テキスト配置 | 各カード内のお題テキストは、水平方向・中央揃えで配置すること。 |

## 4\. 非機能要件

### 4.1. 実行環境

| 項目 | 要件 |
| :--- | :--- |
| **OS** | Windows, macOS, Linux 等、Python実行環境が構築可能なOS |
| **言語** | Python 3.x |
| **必須ライブラリ** | `fpdf2` |
| **フォント** | 日本語表示のため、TrueTypeフォントファイル（例: `ipaexg.ttf`）がスクリプトと同一ディレクトリに配置されていること。 |

### 4.2. ユーザビリティ

| 項目 | 要件 |
| :--- | :--- |
| **設定の容易性** | 利用者はPythonスクリプトの指定された箇所（ファイル上部）の変数を書き換えるだけで、全設定が完了すること。 |
| **操作性** | コマンドライン（ターミナル）から単一のコマンドで実行が完結すること。 |
| **フィードバック** | 実行時に処理の進捗（ページ作成状況）や、完了/エラーメッセージがコンソール上に出力されること。 |

## 5\. 成果物

1.  本要件定義書
2.  上記要件を満たすPythonスクリプト 1式
3.  ツール実行によって生成されるPDFファイル

## 6\. (参考実装) Pythonスクリプト

```python
# FPDFライブラリをインポート
from fpdf import FPDF

# --- 設定項目 ---

# REQ-001: お題リスト定義
ODAI_LIST = [
    "ビールで乾杯する様子",
    "ジャンプするカエル",
    "満員電車で通勤する人",
    "タバコ休憩するゴリラ",
    "フロアを歩き回るファラオさん<br>(※走り回るでも可)",
]

# REQ-002: グループ数指定
NUM_GROUPS = 9

# REQ-003: レイアウト指定
COLS = 3  # 横に並べる数 (列数)
ROWS = 3  # 縦に並べる数 (行数)

# REQ-004: ファイル名指定
FILENAME = "odai_cards_groups.pdf"

# --- 実装部 ---

# REQ-007: カード枚数計算
total_odai_list = ODAI_LIST * NUM_GROUPS
cards_per_page = COLS * ROWS

# REQ-005: 用紙設定
pdf = FPDF(orientation='P', unit='mm', format='A4')

# REQ-006: 日本語表示
try:
    pdf.add_font('ipaexg', '', 'ipaexg.ttf', uni=True)
except Exception as e:
    print(f"フォントファイル 'ipaexg.ttf' が見つかりません。")
    print(f"このスクリプトと同じフォルダにフォントファイルを置いてください。エラー: {e}")
    exit()

margin = 10
page_width = 210 - (margin * 2)
page_height = 297 - (margin * 2)
card_width = page_width / COLS
card_height = page_height / ROWS

for i, odai_text in enumerate(total_odai_list):
    # REQ-008: 自動改ページ
    if i % cards_per_page == 0:
        pdf.add_page()
        print(f"{(i // cards_per_page) + 1}ページ目を作成中...")

    page_index = i % cards_per_page
    col = page_index % COLS
    row = page_index // COLS
    
    # REQ-009: グリッドレイアウト
    x = margin + (col * card_width)
    y = margin + (row * card_height)

    pdf.set_font('ipaexg', '', 16)
    
    # REQ-010: 罫線描画
    pdf.set_line_width(0.2)
    pdf.rect(x, y, card_width, card_height)

    # REQ-011: テキスト配置
    text_height = 10 
    pdf.set_xy(x, y + (card_height - text_height) / 2) 
    pdf.multi_cell(card_width, text_height, odai_text, align='C')

pdf.output(FILENAME)

total_pages = -(-len(total_odai_list) // cards_per_page)
print("-" * 20)
print(f"'{FILENAME}' の作成が完了しました！")
print(f"合計 {len(ODAI_LIST)}個のお題 x {NUM_GROUPS}グループ分 = {len(total_odai_list)}枚のカードを、{total_pages}ページにわたって作成しました。")

```